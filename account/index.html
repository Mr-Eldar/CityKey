<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/account/css/main.css">
    <title>–ì–æ—Ä–æ–¥—Å–∫–æ–π –ö–ª—é—á</title>
</head>
<body>
    <header>
        <div class="container">
            <div class="head__navigation">
                <ul class="navigation">
                    <li class="nav__item">
                        <img class="head__logo" src="/home/src/citykey__logo.png" alt="logo">
                    </li>
                    <li class="nav__item">
                        <ul class="item__links">
                            <li class="links__item">
                                <a href="/home/index.html">–ì–ª–∞–≤–Ω–∞—è</a>
                            </li>
                            <li class="links__item">
                                <a href="">–û –Ω–∞—Å</a>
                            </li>
                            <li class="links__item">
                                <a href="">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
                            </li>
                            <li class="links__item">
                                <a href="">–í–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ</a>
                            </li>
                            <li class="links__item">
                                <a href="">–û—Ç–∑—ã–≤—ã</a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav__item">
                        <div id='head__buttons' class="head__buttons">
                            <a href="/register/register_login.html"><div class="btn__reg">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div></a>
                            <div class="vertical__line"></div>
                            <a href="/register/register_login.html"><div class="btn__log">–í—Ö–æ–¥</div></a>
                        </div>
                        <div class="account">
                            <a href="/account/index.html"><span id="user-name"></span></a>
                            <!-- –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                            <img id="user-image" src="" alt="User Image">
                            <!-- <button id="logout-btn">–í—ã–π—Ç–∏</button>   -->
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <h1 class="main__title">–õ–∏—á–Ω—ã–π –ö–∞–±–∏–Ω–µ—Ç</h1>

            <div class="account__info">
                <img id="user-image__2" src="" alt="User Image">

                <div class="text__info">
                    <h2 id="user-name__content">–ò–º—è: <span id="user-name-2"></span></h2>
                    <h2 id="user-email__content">–ü–æ—á—Ç–∞: <span id="user-email"></span></h2>
                </div>
            </div>

            <div class="orders">
                <h3 class="orders__title">–ü–æ–∫–∞ —á—Ç–æ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç</h3>
            </div>
        </div>
    </main>

    <script type="module">
        import {
            initializeApp
        } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";

        import {
            getAuth,
            onAuthStateChanged,
            signOut
        } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        // üîπ Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const firebaseConfig = {
            apiKey: "AIzaSyC2ip3ZNS23CkckzbayIBUGzjzeV4ehngw",
            authDomain: "citykey-45fda.firebaseapp.com",
            projectId: "citykey-45fda",
            storageBucket: "citykey-45fda.firebasestorage.app",
            messagingSenderId: "339147353166",
            appId: "1:339147353166:web:5c83b83a5eaf11b9c6271f"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // üîπ –≠–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        const logoutBtn = document.getElementById("logout-btn");
        const accountSection = document.querySelector(".account");
        const headButtons = document.getElementById("head__buttons");
        const userNameSpan2 = document.getElementById("user-name-2");
        const userNameSpan = document.getElementById("user-name");
        const userImage = document.getElementById("user-image"); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const userImage2 = document.getElementById("user-image__2"); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const userEmailSpan = document.getElementById("user-email");

        // üîπ –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        onAuthStateChanged(auth, (user) => {
            if (user) {
                headButtons.style.display = "none"; // ‚ùå –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ "–í—Ö–æ–¥" –∏ "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"
                accountSection.style.display = "flex"; // ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é –∞–∫–∫–∞—É–Ω—Ç–∞

                userNameSpan.textContent = user.displayName || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å";
                userNameSpan2.textContent = user.displayName || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å";
                userEmailSpan.textContent = user.email;

                if (user.photoURL) {
                    userImage.src = user.photoURL; // ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    userImage2.src = user.photoURL; // ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    userImage.style.display = "block"; // –î–µ–ª–∞–µ–º —Ñ–æ—Ç–æ –≤–∏–¥–∏–º—ã–º
                } else {
                    userImage.style.display = "none"; // ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ç–æ, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                    userImage2.src = "/home/src/icons/account__default-img.png";
                }
            } else {
                headButtons.style.display = "flex"; // ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞
                accountSection.style.display = "none"; // ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é –∞–∫–∫–∞—É–Ω—Ç–∞
                userImage.style.display = "none"; // ‚ùå –£–±–∏—Ä–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É
            }
        });


        // üîπ –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
        logoutBtn.addEventListener("click", () => {
            signOut(auth).then(() => {
                window.location.reload(); // ‚úÖ –ü—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞
            }).catch(error => {
                alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ: " + error.message);
            });
        });
</script>
</body>
</html>
